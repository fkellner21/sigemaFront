<div class="titulo text-center my-1">Listado de mantenimientos</div>

<div class="row me-0">
    <div class="row pe-0 justify-content-between align-items-center">
        <div class="col-4">
            <mat-form-field class="w-100">
                <mat-label>Buscar</mat-label>
                <input matInput (keyup)="applyFilter($event)" />
            </mat-form-field>
        </div>
        <div class="col-4 text-end">
            <button class="btn btn-dark">Nuevo mantenimiento</button>
        </div>
    </div>

    <div>
        <table
            mat-table
            [dataSource]="dataSource"
            class="mat-elevation-z8 table table-striped table-hover"
        >
            <ng-container matColumnDef="fecha">
                <th
                    mat-header-cell
                    *matHeaderCellDef
                    class="bg-dark text-white"
                >
                    Fecha
                </th>
                <td mat-cell *matCellDef="let m">
                    {{ m.fechaMantenimiento | date }}
                </td>
            </ng-container>

            <ng-container matColumnDef="vehiculo">
                <th
                    mat-header-cell
                    *matHeaderCellDef
                    class="bg-dark text-white"
                >
                    Equipo
                </th>
                <td mat-cell *matCellDef="let m">
                    {{
                        m.equipo?.matricula || m.equipo?.nombre || "Sin equipo"
                    }}
                </td>
            </ng-container>

            <ng-container matColumnDef="detalle">
                <th
                    mat-header-cell
                    *matHeaderCellDef
                    class="bg-dark text-white"
                >
                    Detalle
                </th>
                <td mat-cell *matCellDef="let m">{{ m.descripcion }}</td>
            </ng-container>

            <ng-container matColumnDef="acciones">
                <th
                    mat-header-cell
                    *matHeaderCellDef
                    class="bg-dark text-white text-center"
                >
                    Acciones
                </th>
                <td mat-cell *matCellDef="let m" class="text-center">
                    <button class="btn btn-dark btn-sm me-2" title="Editar">
                        <i class="bi bi-pencil"></i>
                    </button>
                    <button
                        class="btn btn-danger btn-sm"
                        (click)="eliminarMantenimiento(m.id)"
                        title="Eliminar"
                    >
                        <i class="bi bi-trash"></i>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" [attr.colspan]="displayedColumns.length">
                    No hay mantenimientos que coincidan con "{{ filtro }}"
                </td>
            </tr>
        </table>
    </div>
</div>

<div class="text-center my-3" *ngIf="isLoading">
    <div class="spinner-border text-dark" role="status">
        <span class="visually-hidden">Cargando...</span>
    </div>
</div>
